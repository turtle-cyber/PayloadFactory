┌─────────────────────────────────────────────────────────────────────────────┐
│ COMPLETE FUZZING DATA FLOW │
├─────────────────────────────────────────────────────────────────────────────┤
│ │
│ Stage 2 Output │
│ ================ │
│ exploit_login_cwe89.py ────────────────────────────────────┐ │
│ payload_login_cwe89.bin ───────────────────────────────────┤ │
│ │ │
│ ▼ │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ SmartHybridFuzzer.run_session() │ │
│ │ │ │
│ │ payload = b"' OR '1'='1" │ │
│ │ cwe_type = "CWE-89" │ │
│ │ │ │
│ │ ┌─────────────────────────────────────────────────────────────┐ │ │
│ │ │ Layer 1: mutate_payload() │ │ │
│ │ │ │ │ │
│ │ │ b"' OR '1'='1" → b"' OR '1'='1--" (variant 1) │ │ │
│ │ │ → b"' OR '1'='1#" (variant 2) │ │ │
│ │ │ → b"' oR '1'='1" (variant 3) │ │ │
│ │ │ │ │ │
│ │ │ For each variant: │ │ │
│ │ │ result = send_payload(variant) ──────┐ │ │ │
│ │ │ │ │ │ │
│ │ │ ┌──────────────────────────────────────┘ │ │ │
│ │ │ │ │ │ │
│ │ │ ▼ TARGET SERVER (192.168.1.10:8080) │ │ │
│ │ │ ┌───────────────────────────────────┐ │ │ │
│ │ │ │ HTTP/1.1 200 OK │ ← Response │ │ │
│ │ │ │ {"error": "Invalid login"} │ │ │ │
│ │ │ └───────────────────────────────────┘ │ │ │
│ │ │ OR │ │ │
│ │ │ ┌───────────────────────────────────┐ │ │ │
│ │ │ │ Connection Reset │ ← CRASH! │ │ │
│ │ │ └───────────────────────────────────┘ │ │ │
│ │ │ OR │ │ │
│ │ │ ┌───────────────────────────────────┐ │ │ │
│ │ │ │ uid=0(root) gid=0(root) │ ← RCE! │ │ │
│ │ │ └───────────────────────────────────┘ │ │ │
│ │ └─────────────────────────────────────────────────────────────┘ │ │
│ │ │ │
│ │ If Layer 1 fails → Layer 2 (Boofuzz) → Layer 3 (LLM) │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│ │ │
│ ▼ │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ FeedbackContext │ │
│ │ crash_detected: True/False │ │
│ │ response_code: 200/500/etc │ │
│ │ latency: 150ms │ │
│ │ successful_patterns: [...] │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│ │ │
│ ▼ │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ RLAgent.optimize_exploit() │ │
│ │ │ │
│ │ reward = 2.0 (RCE) / 1.0 (crash) / -0.5 (blocked) │ │
│ │ update Q-table │ │
│ │ generate optimized payload using best learned action │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│ │ │
│ ▼ │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │ OUTPUT │ │
│ │ • exploit_login_cwe89.py (updated if RCE confirmed) │ │
│ │ • Confirmed RCE/crash logged │ │
│ │ • Optimized payload saved │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
│ │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│ FUZZER FEEDBACK SOURCES │
├─────────────────────────────────────────────────────────────────────────┤
│ │
│ ATTACKER MACHINE TARGET MACHINE │
│ ================== ============== │
│ │
│ ┌─────────────────┐ ┌─────────────────┐ │
│ │ SmartHybridFuzzer│ ─── Payload ────► │ Vulnerable │ │
│ │ │ │ Application │ │
│ │ │ ◄── Response ──── │ (Tomcat, etc.) │ │
│ └─────────────────┘ └─────────────────┘ │
│ │ │ │
│ │ │ │
│ │ ┌─────────────────────────────────────┘ │
│ │ │ │
│ │ │ If crash/error occurs, system logs it: │
│ │ │ - /var/log/syslog: "segfault at 0x41414141" │
│ │ │ - /var/log/auth.log: "authentication failure" │
│ │ │ - Application log: "java.lang.OutOfMemoryError" │
│ │ │ │
│ │ ▼ │
│ │ ┌─────────────────┐ │
│ │ │ linux_agent.py │ ← Deployed agent monitors logs │
│ │ │ │ │
│ │ │ Watches: │ │
│ │ │ - syslog │ │
│ │ │ - auth.log │ │
│ │ │ - kern.log │ │
│ │ └────────┬────────┘ │
│ │ │ │
│ │ │ POST /agent/logs │
│ │ │ {"message": "segfault", "timestamp": ...} │
│ │ │ │
│ ▼ ▼ │
│ ┌─────────────────────────────┐ │
│ │ MongoDB │ │
│ │ ┌─────────────────────┐ │ │
│ │ │ agent_logs collection│ │ ← Stores logs from target │
│ │ └─────────────────────┘ │ │
│ │ ┌─────────────────────┐ │ │
│ │ │ scan_logs collection │ │ ← Stores fuzzing results │
│ │ └─────────────────────┘ │ │
│ └─────────────────────────────┘ │
│ │ │
│ │ Fuzzer queries both sources: │
│ │ 1. Direct response (socket) │
│ │ 2. Agent logs (MongoDB) │
│ ▼ │
│ ┌─────────────────────────────┐ │
│ │ Final Crash Determination │ │
│ │ │ │
│ │ crash = socket_crash OR │ │
│ │ agent_reported_crash│ │
│ └─────────────────────────────┘ │
│ │
└─────────────────────────────────────────────────────────────────────────┘
